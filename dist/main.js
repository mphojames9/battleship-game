(()=>{const e=document.querySelector("#gamesboard-container"),t=document.querySelector(".option-container"),o=document.querySelector("#flip-button");new Audio("../src/images/sounds/music.mp3"),new Audio("../src/images/sounds/background_sound.mp3");let n=new Audio("../src/images/sounds/fire_shot.mp3"),r=new Audio("../src/images/sounds/shot_hit.mp3"),s=new Audio("../src/images/sounds/shot_miss.mp3");const a=document.querySelector(".inputName"),l=document.querySelector(".input-container"),c=document.querySelector(".submitBtn"),i=[];c.addEventListener("click",(e=>{e.preventDefault();const t=a.value.trim();t?(i.push(t),console.log(i[0]),l.classList.add("fade"),setTimeout((()=>{l.style.display="none"}),3e3)):alert("Please enter your name to statrt")}));let u=0;o.addEventListener("click",(function(){const e=Array.from(t.children);u=0===u?90:0,e.forEach((e=>e.style.transform=`rotate(${u}deg)`))}));const d=10;function m(t,o){const n=document.createElement("div");n.classList.add("game-board"),n.style.backgroundColor=t,n.id=o;for(let e=0;e<d*d;e++){const t=document.createElement("div");t.classList.add("block"),t.id=e,n.append(t)}e.append(n)}m("rgba(0, 0, 0, 0.850)","player"),m("rgba(0, 0, 0, 0.850","computer");class p{constructor(e,t){this.name=e,this.length=t}}const y=[new p("destroyer","2"),new p("submarine","3"),new p("cruiser","3"),new p("battleship","4"),new p("carrier","5")];let h,f;function g(e,t,o){const n=document.querySelectorAll(`#${e} div`);let r,s=Math.random()<.5,a="player"===e?0===u:s,l=Math.floor(Math.random()*d*d),c=o||l,i=a?c<=d*d-t.length?c:d*d-t.length:c<=d*d-d*t.length?c:c-t.length*d+d,m=[];for(let e=0;e<t.length;e++)a?m.push(n[Number(i)+e]):m.push(n[Number(i)+e*d]);a?m.every(((e,t)=>r=m[0].id%d!=d-(m.length-(t+1)))):m.every(((e,t)=>r=m[0].id<d*t+1+90));const p=m.every((e=>!e.classList.contains("taken")));r&&p?m.forEach((e=>{e.classList.add(t.name),e.classList.add("taken")})):("computer"===e&&g(t),"player"===e&&(h=!0))}function L(e){h=!1,f=e.target}function S(e){e.preventDefault()}function b(e){const o=e.target.id;g("player",y[f.id],o),0==t.children.length-1&&setTimeout(w,100),h||f.remove()}y.forEach((e=>g("computer",e))),Array.from(t.children).forEach((e=>e.addEventListener("dragstart",L))),document.querySelectorAll("#player div").forEach((e=>{e.addEventListener("dragover",S),e.addEventListener("drop",b)})),document.querySelector("#start-button");const k=document.querySelector("#info"),v=document.querySelector("#turn-display"),C=document.querySelector("#computer"),q=document.querySelector(".game-container"),E=document.querySelector(".option-container");let A,x=!1;function w(){0==t.children.length&&(allBoardBlocks=document.querySelectorAll("#computer div"),allBoardBlocks.forEach((e=>e.addEventListener("click",$))),setTimeout((()=>{q.classList.add("fade")}),100),setTimeout((()=>{q.classList.add("fadeIn"),C.style.display="flex",o.style.display="none",E.style.display="none"}),2e3),A=!0,v.textContent="Your Turn!",k.textContent="The game has Started")}let T=[],Y=[];const M=[],B=[];function $(e){if(!x){if(e.target.classList.contains("taken")){e.target.classList.add("boom"),k.textContent="You hit the computer's ship",r.play();let t=Array.from(e.target.classList);t=t.filter((e=>"block"!==e)),t=t.filter((e=>"boom"!==e)),t=t.filter((e=>"taken"!==e)),T.push(...t),D("player",T,M)}e.target.classList.contains("taken")||(k.textContent="You Missed",s.play(),e.target.classList.add("empty")),A=!1,document.querySelectorAll("#computer div").forEach((e=>e.replaceWith(e.cloneNode(!0)))),setTimeout(I,3e3)}}function I(){x||(v.textContent="Computer's Turn",k.textContent="The Computer Is Arming...",n.play()),setTimeout((()=>{let e=Math.floor(Math.random()*d*d);const t=document.querySelectorAll("#player div");if(t[e].classList.contains("taken")&&t[e].classList.contains("boom"))I();else if(t[e].classList.contains("taken")&&!t[e].classList.contains("boom")){t[e].classList.add("boom"),k.textContent="The Computer Hits Your Ship",r.play();let o=Array.from(t[e].classList);o=o.filter((e=>"block"!==e)),o=o.filter((e=>"boom"!==e)),o=o.filter((e=>"taken"!==e)),Y.push(...o),D("computer",Y,B)}else k.textContent="Computer Missed",s.play(),t[e].classList.add("empty")}),2e3),setTimeout((()=>{A=!0,v.textContent="Your Turn!",k.textContent="Shoot!!!",document.querySelectorAll("#computer div").forEach((e=>e.addEventListener("click",$)))}),2e3)}const N=document.querySelector("#winnerDisplay"),_=document.querySelector(".gameOver-container");function D(e,t,o){function n(n,r){t.filter((e=>e===n)).length===r&&("player"===e&&(k.textContent=`You sunk the computer's ${n}`,T=t.filter((e=>e!==n))),"computer"===e&&(k.textContent=`Computer sunk your ${n}`,Y=t.filter((e=>e!==n))),o.push(n))}if(n("destroyer",2),n("submarine",3),n("cruiser",3),n("battleship",4),n("carrier",5),console.log("playerHits",T),console.log("playerSunkShips",M),5===M.length){let e=i[0];N.textContent=`Congradulations ${e} You sunk all the computers ships . You won!`,H()}5===B.length&&(_.classList.add("fadeIn"),N.textContent="Computer sunk all you ships you, lost the game",H())}function H(){_.classList.add("fadeIn"),_.style.display="flex"}console.log(N),document.querySelectorAll("#restart-button").forEach((e=>e.addEventListener("click",(()=>{window.location.reload()}))))})();