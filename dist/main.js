(()=>{const e=document.querySelector("#gamesboard-container"),t=document.querySelector(".option-container"),o=document.querySelector("#flip-button");let n=new Audio("../src/images/sounds/music.mp3"),s=(new Audio("../src/images/sounds/background_sound.mp3"),new Audio("../src/images/sounds/fire_shot.mp3")),r=new Audio("../src/images/sounds/fire_shot.mp3"),a=new Audio("../src/images/sounds/shot_hit.mp3"),l=new Audio("../src/images/sounds/shot_miss.mp3"),c=new Audio("../src/images/sounds/shot_hit.mp3"),i=new Audio("../src/images/sounds/shot_miss.mp3");const u=document.querySelector(".inputName"),d=document.querySelector(".input-container"),m=document.querySelector(".submitBtn"),p=[];m.addEventListener("click",(e=>{e.preventDefault();const t=u.value.trim();t?(p.push(t),console.log(p[0]),d.classList.add("fade"),setTimeout((()=>{d.style.display="none",n.play()}),3e3)):alert("Please enter your name to statrt")}));let y=0;o.addEventListener("click",(function(){const e=Array.from(t.children);y=0===y?90:0,e.forEach((e=>e.style.transform=`rotate(${y}deg)`))}));const h=10;function f(t,o){const n=document.createElement("div");n.classList.add("game-board"),n.style.backgroundColor=t,n.id=o;for(let e=0;e<h*h;e++){const t=document.createElement("div");t.classList.add("block"),t.id=e,n.append(t)}e.append(n)}f("rgba(0, 0, 0, 0.850)","player"),f("rgba(0, 0, 0, 0.850","computer");class g{constructor(e,t){this.name=e,this.length=t}}const L=[new g("destroyer","2"),new g("submarine","3"),new g("cruiser","3"),new g("battleship","4"),new g("carrier","5")];let S,b;function k(e,t,o){const n=document.querySelectorAll(`#${e} div`);let s,r=Math.random()<.5,a="player"===e?0===y:r,l=Math.floor(Math.random()*h*h),c=o||l,i=a?c<=h*h-t.length?c:h*h-t.length:c<=h*h-h*t.length?c:c-t.length*h+h,u=[];for(let e=0;e<t.length;e++)a?u.push(n[Number(i)+e]):u.push(n[Number(i)+e*h]);a?u.every(((e,t)=>s=u[0].id%h!=h-(u.length-(t+1)))):u.every(((e,t)=>s=u[0].id<h*t+1+90));const d=u.every((e=>!e.classList.contains("taken")));s&&d?u.forEach((e=>{e.classList.add(t.name),e.classList.add("taken")})):("computer"===e&&k(t),"player"===e&&(S=!0))}function v(e){S=!1,b=e.target}function C(e){e.preventDefault()}function q(e){const o=e.target.id;k("player",L[b.id],o),0==t.children.length-1&&setTimeout(_,100),S||b.remove()}L.forEach((e=>k("computer",e))),Array.from(t.children).forEach((e=>e.addEventListener("dragstart",v))),document.querySelectorAll("#player div").forEach((e=>{e.addEventListener("dragover",C),e.addEventListener("drop",q)})),document.querySelector("#start-button");const A=document.querySelector("#info"),E=document.querySelector("#turn-display"),w=document.querySelector("#computer"),T=document.querySelector(".game-container"),x=document.querySelector(".option-container");let Y,M=!1;function _(){0==t.children.length&&(allBoardBlocks=document.querySelectorAll("#computer div"),allBoardBlocks.forEach((e=>e.addEventListener("click",D))),setTimeout((()=>{T.classList.add("fade")}),100),setTimeout((()=>{T.classList.add("fadeIn"),w.style.display="flex",o.style.display="none",x.style.display="none"}),2e3),Y=!0,E.textContent="Your Turn!",A.textContent="The game has Started")}let B=[],$=[];const I=[],N=[];function D(e){if(!M){if(r.play(),e.target.classList.contains("taken")){e.target.classList.add("boom"),A.textContent="You hit the computer's ship";let t=Array.from(e.target.classList);t=t.filter((e=>"block"!==e)),t=t.filter((e=>"boom"!==e)),t=t.filter((e=>"taken"!==e)),B.push(...t),W("player",B,I),setTimeout((()=>{c.play()}),700)}e.target.classList.contains("taken")||(A.textContent="You Missed",e.target.classList.add("empty"),setTimeout((()=>{i.play()}),700)),Y=!1,document.querySelectorAll("#computer div").forEach((e=>e.replaceWith(e.cloneNode(!0)))),setTimeout(H,3e3)}}function H(){M||(E.textContent="Computer's Turn",A.textContent="The Computer Is Arming...",s.play()),M||(setTimeout((()=>{let e=Math.floor(Math.random()*h*h);const t=document.querySelectorAll("#player div");if(t[e].classList.contains("taken")&&t[e].classList.contains("boom"))H();else if(t[e].classList.contains("taken")&&!t[e].classList.contains("boom")){t[e].classList.add("boom"),A.textContent="The Computer Hits Your Ship",a.play();let o=Array.from(t[e].classList);o=o.filter((e=>"block"!==e)),o=o.filter((e=>"boom"!==e)),o=o.filter((e=>"taken"!==e)),$.push(...o),W("computer",$,N)}else A.textContent="Computer Missed",l.play(),t[e].classList.add("empty")}),2e3),setTimeout((()=>{Y=!0,E.textContent="Your Turn!",A.textContent="Shoot!!!",document.querySelectorAll("#computer div").forEach((e=>e.addEventListener("click",D)))}),5e3))}const O=document.querySelector("#winnerDisplay"),P=document.querySelector(".gameOver-container");function W(e,t,o){function n(n,s){t.filter((e=>e===n)).length===s&&("player"===e&&(A.textContent=`You sunk the computer's ${n}`,B=t.filter((e=>e!==n))),"computer"===e&&(A.textContent=`Computer sunk your ${n}`,$=t.filter((e=>e!==n))),o.push(n))}if(n("destroyer",2),n("submarine",3),n("cruiser",3),n("battleship",4),n("carrier",5),console.log("playerHits",B),console.log("playerSunkShips",I),5===I.length){M=!0;let e=p[0];O.textContent=`Congradulations ${e} You sunk all the computers ships . You won!`,setTimeout(j(),1e3)}5===N.length&&(M=!0,P.classList.add("fadeIn"),O.textContent="Computer sunk all you ships you, lost the game",setTimeout(j(),1e3))}function j(){P.classList.add("fadeIn"),P.style.display="flex"}document.querySelectorAll("#restart-button").forEach((e=>e.addEventListener("click",(()=>{window.location.reload()}))))})();